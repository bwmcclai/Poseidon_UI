<!DOCTYPE html>
<html lang="en" ng-app="rovUI" ng-controller="ROVController">
    <head>        
        <!-- META SECTION -->
        <title>Poseidon UI</title>            
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
		<script type="text/javascript" src="js/angular.min.js"></script>
        <link rel="icon" href="faviconbr.ico" type="image/x-icon" />
        <!-- END META SECTION -->
        
        <!-- CSS INCLUDE -->        
        <link rel="stylesheet" type="text/css" id="theme" href="css/theme-default.css"/>
        <!-- EOF CSS INCLUDE -->   
			<script type="text/javascript">
        var ws;
        var wsUri = "ws:";
        var loc = window.location;
        console.log(loc);
        if (loc.protocol === "https:") { wsUri = "wss:"; }
        // This needs to point to the web socket in the Node-RED flow
		//wsUri += "//" + loc.host + loc.pathname.replace("index.html","ws/ui");
		var wsName = "ws/ui";
		wsUri +="//192.168.2.2:1880/" + wsName;
		

        function wsConnect() {
            console.log("connect",wsUri);
            ws = new WebSocket(wsUri);
            //var line = "";    // either uncomment this for a building list of messages
            ws.onmessage = function(msg) {
                var line = "";  // or uncomment this to overwrite the existing message
                // parse the incoming message as a JSON object
                var data = msg.data;
                 var element = data.split("=")[0]
                var value = data.split("=")[1]
                
                //this would only work if I am placing the data into an innerHTML (might have to split it out later)
                document.getElementById(element).innerHTML = value; 




		document.getElementById('uri').innerHTML = wsUri;             
		//ws.send(JSON.stringify({data:data}));
            }
            ws.onopen = function() {
                // update the status div with the connection status
                document.getElementById('ws_status').innerHTML = "Connected";
				document.getElementById('ws_name').innerHTML = "Node-Red Data: " + wsName;
                //ws.send("Open for data");
                console.log("connected");
				sendData('getContent');
            }
            ws.onclose = function() {
                // update the status div with the connection status
                document.getElementById('ws_status').innerHTML = "Not Connected";
				document.getElementById('ws_name').innerHTML = "Node-Red Data: " + wsName;
                // in case of lost connection tries to reconnect every 3 secs
                setTimeout(wsConnect,3000);
            }
        }
        
       
		
		function sendData(command) {
            if (ws) { ws.send(command); }
        }
    </script>
    </head>
    <body onload="wsConnect();" onunload="ws.disconnect();">
        <!-- START PAGE CONTAINER -->
        <div class="page-container">
            
            <!-- START PAGE SIDEBAR -->
            <div class="page-sidebar">
                <!-- START X-NAVIGATION -->
                <ul class="x-navigation">
                    <li class="xn-logo">
                        <a href="index.html">Poseidon UI</a>
                        <a href="#" class="x-navigation-control"></a>
                    </li>
                    
                    <li class="xn-title">Navigation</li>
                    <li class="active">
                        <a href="index.html"><span class="fa fa-desktop"></span> <span class="xn-text">Dashboard</span></a>
						                         
                    </li>                    
                    <li class="xn-openable">
                        <a href="#"><span class="fa fa-cogs"></span> <span class="xn-text">Systems</span></a>
                        <ul>
                            <li><a href="raspberry_pi.html"><span class="fa fa-linux"></span> Raspberry Pi</a></li>
                            <li><a href="index.html"><span class="fa fa-hdd-o"></span> Pixhawk</a></li>
                            <li><a href="index.html"><span class="fa fa-anchor"></span> ROV</a></li>
							<li><a href="index.html"><span class="fa fa-gamepad"></span> Controls</a></li>              
                        </ul>
                    </li>
					<li>
						<a href="configuration.html"><span class="fa fa-cog"></span> <span class="xn-text">Configuration</span></a>
					</li>
                   
                </ul>
                <!-- END X-NAVIGATION -->
            </div>
            <!-- END PAGE SIDEBAR -->
            
            <!-- PAGE CONTENT -->
            <div class="page-content">
                
                <!-- START X-NAVIGATION VERTICAL -->
                <ul class="x-navigation x-navigation-horizontal x-navigation-panel">
                    <!-- TOGGLE NAVIGATION -->
                    <li class="xn-icon-button">
                        <a href="#" class="x-navigation-minimize"><span class="fa fa-dedent"></span></a>
                    </li>
                    <!-- END TOGGLE NAVIGATION -->

                    <!-- ALERTS -->
                    <li class="xn-icon-button pull-right">
                        <a href="#"><span class="fa fa-exclamation-triangle"></span></a>

                        <div class="informer informer-danger">3</div>
                        <div class="panel panel-primary animated zoomIn xn-drop-left xn-panel-dragging">
                            <div class="panel-heading">
                                <h3 class="panel-title"><span class="fa fa-exclamation-triangle"></span> Alerts</h3>                                
                                <div class="pull-right">
                                    <span class="label label-danger">3 new</span>
                                </div>
                            </div>
                            <div class="panel-body list-group list-group-contacts scroll" style="height: 200px;">
                                <a href="#" class="list-group-item">
                                    <div class="list-group-status status-online"></div>
                                    
                                    <span class="contacts-title">2 seconds ago</span>
                                    <p>Raspberry Pi - High CPU Temp</p>
                                </a>
                                <a href="#" class="list-group-item">
                                    <div class="list-group-status status-away"></div>
                                   
                                    <span class="contacts-title">45 seconds ago</span>
                                    <p>ROV - Power at 20%</p>
                                </a>
                                <a href="#" class="list-group-item">
                                    <div class="list-group-status status-away"></div>
                                    
                                    <span class="contacts-title">6 minutes ago</span>
                                    <p>Lost connection to Pixhawk</p>
                                </a>
                               
                            </div>     
                            <div class="panel-footer text-center">
                                <a href="pages-messages.html">Show all alerts</a>
                            </div>                            
                        </div>                        
                    </li>
                    <!-- END ALERTS -->
                    
                </ul>
                <!-- END X-NAVIGATION VERTICAL -->                     

                <!-- START BREADCRUMB -->
                <ul class="breadcrumb">
                    <li><a href="#">Home</a></li>                    
                    <li class="active">Dashboard</li>
                </ul>
                <!-- END BREADCRUMB -->                       
                
                <!-- PAGE CONTENT WRAPPER -->
                <div class="page-content-wrap">
                    
                    <!-- START WIDGETS -->                    
                    <div class="row">
                              
                        <div class="col-md-4">
							<div class="widget widget-default widget-carousel">
                                <div class="owl-carousel" id="owl-example">
                                    <div>                                    
                                        <div class="widget-title">Total Dive Count</div>
                                        <div class="widget-subtitle"></div>
                                        <div class="widget-int">0</div>
                                    </div>
									<div>                                    
                                        <div class="widget-title">Last Dive</div>                                                                        
                                        <div class="widget-subtitle"></div>
                                        <div class="widget-int">Never</div>
                                    </div>
                                    <div>                                    
                                        <div class="widget-title">Max Depth</div>
                                        <div class="widget-subtitle">ft</div>
                                        <div class="widget-int">0</div>
                                    </div>
									<div>                                    
                                        <div class="widget-title">Longest Dive</div>
                                        <div class="widget-subtitle">Duration</div>
                                        <div class="widget-int">0 minutes</div>
                                    </div>
                                </div>                            
                                                           
                            </div>                         
						</div>
						
						
						<div class="col-md-4">

                            <!-- START WIDGET CLOCK -->
                            <!-- <div class="widget widget-info widget-padding-sm">
                                <div class="widget-big-int" id="upTime2"></div>                            
                                <div class="widget-subtitle ">System UpTime<label id="conn_text"></label></div>
                                                         
                                                       
							</div>  -->
							<div class="widget widget-info widget-padding-sm">
                                <div class="widget-big-int" id="upTime">00:00:00</div>                            
                                <div class="widget-subtitle">System Up Time</div>
								 <!-- <div class="widget-buttons widget-c2">
									<div class="col">
										<a href="#"><span class="fa fa-refresh"></span>  Reboot</a>
									</div>
									<div class="col">
										<a href="#"><span class="fa fa-power-off"></span>  Shutdown</a>
									</div>
									
								</div>      -->                  
                            </div>    

							  
						
						</div>	 
						<div class="col-md-4">
							<div class="widget widget-default widget-no-subtitle">
                                <div class="widget-big-int" id="ws_status">Not Connected</div>                            
                                <div class="widget-subtitle" id="ws_name">Node-Red</div>  
                                
                            </div>                        
						</div>
               
							
					</div>
					<div class="row">
						<div class="col-md-12">
							<!-- START PANEL WITH HIDDEN CONTROLS -->
                            <div class="panel panel-success panel-hidden-controls">
                                <div class="panel-heading">
                                    <h2 class="panel-title">Poseidon UI Info</h2>
                                    <ul class="panel-controls">
                                        <li><a href="#" class="panel-fullscreen"><span class="fa fa-expand"></span></a></li>
										<li><a href="#" class="panel-collapse"><span class="fa fa-angle-down"></span></a></li>
                                        <li><a href="#" class="panel-remove"><span class="fa fa-times"></span></a></li>
                                    </ul>                                
                                </div>
                                <div class="panel-body" id="ui_Info">
                                    Welcome to the new UI for ROV control and configuration.  This interface is hosted from the Raspberry Pi onboard the ROV.  It allows you to connect to the ROV on any device without the need to install any software. 
									</br></br>To start with, the UI will mainly be used to configure subsystems, check system health, and view alarms and history. 
									</br></br>More features are being added daily."
                                </div>      
                                <div class="panel-footer">                                
                                    <!-- <button class="btn btn-primary pull-right" onclick='doit("button Press");'>Sample Send Data back to Node-Red</button> -->
                                </div>                            
                            </div>
                            <!-- END PANEL WITH HIDDEN CONTROLS -->
						</div>
					</div>
					
					
                    <!-- END WIDGETS -->                    
                    
                </div>
                <!-- END PAGE CONTENT WRAPPER -->                                
            </div>            
            <!-- END PAGE CONTENT -->
        </div>
        <!-- END PAGE CONTAINER -->

        <!-- MESSAGE BOX-->
        <div class="message-box animated fadeIn" data-sound="alert" id="mb-signout">
            <div class="mb-container">
                <div class="mb-middle">
                    <div class="mb-title"><span class="fa fa-sign-out"></span> Log <strong>Out</strong> ?</div>
                    <div class="mb-content">
                        <p>Are you sure you want to log out?</p>                    
                        <p>Press No if youwant to continue work. Press Yes to logout current user.</p>
                    </div>
                    <div class="mb-footer">
                        <div class="pull-right">
                            <a href="pages-login.html" class="btn btn-success btn-lg">Yes</a>
                            <button class="btn btn-default btn-lg mb-control-close">No</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- END MESSAGE BOX-->

        <!-- START PRELOADS -->
        <audio id="audio-alert" src="audio/alert.mp3" preload="auto"></audio>
        <audio id="audio-fail" src="audio/fail.mp3" preload="auto"></audio>
        <!-- END PRELOADS -->                  
        
    <!-- START SCRIPTS -->
        <!-- START PLUGINS -->
        <script type="text/javascript" src="js/plugins/jquery/jquery.min.js"></script>
        <script type="text/javascript" src="js/plugins/jquery/jquery-ui.min.js"></script>
        <script type="text/javascript" src="js/plugins/bootstrap/bootstrap.min.js"></script>        
        <!-- END PLUGINS -->

        <!-- START THIS PAGE PLUGINS-->        
        <script type='text/javascript' src='js/plugins/icheck/icheck.min.js'></script>        
        <script type="text/javascript" src="js/plugins/mcustomscrollbar/jquery.mCustomScrollbar.min.js"></script>
        <script type="text/javascript" src="js/plugins/scrolltotop/scrolltopcontrol.js"></script>
        
        <script type="text/javascript" src="js/plugins/morris/raphael-min.js"></script>
        <script type="text/javascript" src="js/plugins/morris/morris.min.js"></script>       
        <script type="text/javascript" src="js/plugins/rickshaw/d3.v3.js"></script>
        <script type="text/javascript" src="js/plugins/rickshaw/rickshaw.min.js"></script>
        <script type='text/javascript' src='js/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js'></script>
        <script type='text/javascript' src='js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js'></script>                
        <script type='text/javascript' src='js/plugins/bootstrap/bootstrap-datepicker.js'></script>                
        <script type="text/javascript" src="js/plugins/owl/owl.carousel.min.js"></script>                 
        
        <script type="text/javascript" src="js/plugins/moment.min.js"></script>
        <script type="text/javascript" src="js/plugins/daterangepicker/daterangepicker.js"></script>
        <!-- END THIS PAGE PLUGINS-->        

        <!-- START TEMPLATE -->
       <!-- <script type="text/javascript" src="js/settings.js"></script>-->
        
        <script type="text/javascript" src="js/plugins.js"></script>        
        <script type="text/javascript" src="js/actions.js"></script>
        
        <script type="text/javascript" src="js/demo_dashboard.js"></script>
        <!-- END TEMPLATE -->
    <!-- END SCRIPTS -->         
    </body>
</html>






